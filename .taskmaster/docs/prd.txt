# 팝업 마켓 (Popup Market) - Product Requirements Document

## 1. 프로젝트 개요

### 1.1 프로젝트 목적
팝업 마켓은 임시로 열리는 팝업 스토어와 이벤트를 위한 온라인 플랫폼입니다. 사용자들은 지역의 팝업 스토어를 발견하고, 정보를 확인하며, 일정을 관리할 수 있습니다. 판매자들은 자신의 팝업 스토어를 등록하고 홍보할 수 있습니다.

### 1.2 기술 스택
- **Frontend Framework**: React 19.2.0 + TypeScript 5.9.3 + Vite 7.2.4
- **UI Framework**: Tailwind CSS 4.1.17 + Radix UI
- **Backend**: Supabase (PostgreSQL + Auth + Storage + Realtime)
- **State Management**: React Hooks (useState, useEffect, useContext)
- **Routing**: React Router v6 (추후 추가)
- **Form Handling**: React Hook Form (추후 추가)
- **Supabase Client**: @supabase/supabase-js 2.86.0

### 1.3 사용자 페르소나
- **일반 사용자**: 팝업 스토어를 찾고 방문하고 싶은 사람
- **판매자**: 자신의 팝업 스토어를 홍보하고 싶은 사람
- **관리자**: 플랫폼을 관리하는 사람

---

## 2. 핵심 기능 명세

### 2.1 팝업 스토어 목록 및 검색 [Priority: High]
**기능 설명**: 사용자가 팝업 스토어를 탐색하고 검색할 수 있는 기능

**상세 요구사항**:
- 지역별, 카테고리별 팝업 스토어 목록 조회
- 검색 기능 (이름, 위치, 태그 기반)
- 필터링 기능:
  - 날짜 범위 필터
  - 카테고리 필터
  - 지역 필터
  - 상태 필터 (진행중, 예정, 종료)
- 페이지네이션 (무한 스크롤 또는 페이지 번호)
- 정렬 기능 (최신순, 인기순, 거리순)

**기술 구현**:
- Supabase 쿼리: `popup_stores` 테이블 조회
- 필터링: Supabase PostgREST 필터 사용
- 검색: PostgreSQL Full-Text Search 또는 ILIKE 사용

**의존성**: 데이터베이스 스키마, 인증 시스템

---

### 2.2 팝업 스토어 상세 정보 [Priority: High]
**기능 설명**: 개별 스토어의 상세 정보를 표시하는 페이지

**상세 요구사항**:
- 스토어 기본 정보:
  - 이름, 설명, 카테고리
  - 운영 기간 (시작일, 종료일)
  - 운영 시간 (JSONB 형식)
- 위치 정보:
  - 주소 (텍스트)
  - 좌표 (위도, 경도)
  - 지도 표시 (Google Maps 또는 Kakao Map)
- 미디어:
  - 이미지 갤러리 (여러 장)
  - 이미지 확대 보기
- 연락처 정보:
  - 전화번호, 이메일
  - SNS 링크 (인스타그램, 페이스북 등)
- 리뷰 및 평점:
  - 평균 평점 표시
  - 리뷰 목록 (최신순)
  - 리뷰 작성 버튼 (로그인 사용자만)

**기술 구현**:
- Supabase 쿼리: `popup_stores` 단일 조회 + `reviews` 조인
- 이미지: Supabase Storage에서 로드
- 지도: 외부 지도 API 통합

**의존성**: 스토어 목록, 리뷰 시스템

---

### 2.3 사용자 인증 및 프로필 [Priority: High]
**기능 설명**: 사용자 인증 및 프로필 관리 기능

**상세 요구사항**:
- 인증:
  - 이메일/비밀번호 회원가입
  - 이메일/비밀번호 로그인
  - 소셜 로그인 (Google, Kakao - 추후 추가)
  - 로그아웃
  - 비밀번호 재설정
- 프로필 관리:
  - 프로필 정보 조회/수정
  - 사용자명, 아바타 이미지
  - 역할 관리 (user, seller, admin)
- 즐겨찾기:
  - 스토어 즐겨찾기 추가/제거
  - 즐겨찾기 목록 조회
- 방문 예정 스토어 관리 (추후 추가)

**기술 구현**:
- Supabase Auth 사용
- `profiles` 테이블: 사용자 프로필 정보 저장
- `favorites` 테이블: 즐겨찾기 관계 저장

**의존성**: Supabase 프로젝트 설정, 데이터베이스 스키마

---

### 2.4 스토어 등록 및 관리 (판매자) [Priority: High]
**기능 설명**: 판매자가 팝업 스토어를 등록하고 관리하는 기능

**상세 요구사항**:
- 스토어 등록:
  - 기본 정보 입력 폼:
    - 이름 (필수)
    - 설명 (필수)
    - 카테고리 선택 (필수)
    - 위치 (주소, 좌표) (필수)
    - 운영 기간 (시작일, 종료일) (필수)
    - 운영 시간 (요일별) (필수)
    - 연락처 정보 (전화번호, 이메일, SNS)
    - 태그 (다중 선택)
  - 이미지 업로드:
    - 다중 이미지 업로드
    - 이미지 미리보기
    - 이미지 삭제
    - 최대 이미지 개수 제한
  - 상태 관리:
    - draft: 임시 저장
    - published: 공개
    - ended: 종료
- 스토어 수정:
  - 등록된 스토어 정보 수정
  - 이미지 추가/삭제
- 판매자 대시보드 (추후 추가):
  - 내 스토어 목록
  - 통계 정보

**기술 구현**:
- Supabase Storage: 이미지 업로드
- `popup_stores` 테이블: CRUD 작업
- RLS 정책: 판매자만 자신의 스토어 수정 가능

**의존성**: 인증 시스템, 이미지 업로드 기능

---

### 2.5 리뷰 및 평점 시스템 [Priority: Medium]
**기능 설명**: 사용자가 스토어에 리뷰를 작성하고 평점을 부여하는 기능

**상세 요구사항**:
- 리뷰 작성:
  - 평점 선택 (1-5점)
  - 리뷰 텍스트 작성
  - 이미지 첨부 (선택)
  - 한 사용자당 한 스토어에 하나의 리뷰만 작성 가능
- 리뷰 조회:
  - 스토어별 리뷰 목록
  - 평점별 필터링
  - 최신순/평점순 정렬
- 평점 계산:
  - 평균 평점 자동 계산
  - 평점 분포 표시 (추후 추가)

**기술 구현**:
- `reviews` 테이블: 리뷰 데이터 저장
- RLS 정책: 본인 리뷰만 수정/삭제 가능
- 트리거: 평점 업데이트 시 스토어 평균 평점 자동 계산

**의존성**: 인증 시스템, 스토어 상세 페이지

---

## 3. 데이터 모델

### 3.1 데이터베이스 스키마

#### users (Supabase Auth 기본 제공)
```sql
- id: UUID (PK)
- email: TEXT
- created_at: TIMESTAMP
```

#### profiles
```sql
- id: UUID (PK, FK -> users.id)
- username: VARCHAR(50) UNIQUE
- avatar_url: TEXT
- role: VARCHAR(20) DEFAULT 'user' -- 'user', 'seller', 'admin'
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

#### popup_stores
```sql
- id: UUID (PK)
- seller_id: UUID (FK -> profiles.id)
- name: VARCHAR(200) NOT NULL
- description: TEXT
- category: VARCHAR(50) NOT NULL
- location: VARCHAR(200) NOT NULL
- latitude: DECIMAL(10, 8)
- longitude: DECIMAL(11, 8)
- start_date: DATE NOT NULL
- end_date: DATE NOT NULL
- opening_hours: JSONB -- { "monday": "10:00-18:00", ... }
- contact_info: JSONB -- { "phone": "...", "email": "...", "instagram": "..." }
- images: TEXT[] -- Supabase Storage URLs
- tags: VARCHAR(50)[] -- 태그 배열
- status: VARCHAR(20) DEFAULT 'draft' -- 'draft', 'published', 'ended'
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

#### reviews
```sql
- id: UUID (PK)
- store_id: UUID (FK -> popup_stores.id)
- user_id: UUID (FK -> profiles.id)
- rating: INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5)
- comment: TEXT
- images: TEXT[] -- Supabase Storage URLs
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
UNIQUE(store_id, user_id) -- 한 사용자당 한 스토어에 하나의 리뷰만
```

#### favorites
```sql
- id: UUID (PK)
- user_id: UUID (FK -> profiles.id)
- store_id: UUID (FK -> popup_stores.id)
- created_at: TIMESTAMP
UNIQUE(user_id, store_id) -- 중복 방지
```

### 3.2 인덱스
- `popup_stores`: category, status, start_date, end_date
- `reviews`: store_id, user_id
- `favorites`: user_id, store_id

### 3.3 RLS (Row Level Security) 정책
- **profiles**: 본인만 조회/수정 가능, 모든 사용자 조회 가능
- **popup_stores**: 
  - 조회: published 상태만 공개, 판매자는 자신의 스토어 조회 가능
  - 생성: 인증된 사용자만 가능
  - 수정/삭제: 판매자만 자신의 스토어 수정/삭제 가능
- **reviews**: 
  - 조회: 모든 사용자 가능
  - 생성: 인증된 사용자만 가능
  - 수정/삭제: 본인만 가능
- **favorites**: 본인만 조회/생성/삭제 가능

---

## 4. API 및 통합

### 4.1 Supabase REST API
- **인증**: Supabase Auth API
- **데이터 CRUD**: Supabase PostgREST API
- **파일 저장**: Supabase Storage API
- **실시간**: Supabase Realtime (선택사항)

### 4.2 외부 API 통합
- **지도 API**: Google Maps API 또는 Kakao Map API (추후 추가)
- **이미지 최적화**: Supabase Storage 이미지 변환 기능 활용

---

## 5. 개발 로드맵

### Phase 1: MVP - 기본 인프라 및 인증 [Priority: Critical]
**목표**: 기본 인프라 구축 및 사용자 인증 시스템 구현

**작업 항목**:
1. Supabase 프로젝트 설정 및 연결
2. 데이터베이스 스키마 설계 및 마이그레이션
3. RLS 정책 설정
4. Storage 버킷 생성 및 권한 설정
5. 사용자 인증 시스템 구현:
   - 로그인/회원가입 페이지
   - 프로필 생성 로직
6. 기본 레이아웃 및 네비게이션 구성
7. 프로필 관리 기능

**의존성**: 없음

**예상 기간**: 1-2주

---

### Phase 2: 스토어 목록 및 상세 [Priority: High]
**목표**: 사용자가 스토어를 탐색하고 상세 정보를 확인할 수 있는 기능 구현

**작업 항목**:
1. 팝업 스토어 목록 페이지 구현
2. 검색 기능 구현
3. 필터링 기능 구현
4. 정렬 기능 구현
5. 스토어 상세 페이지 구현
6. 이미지 갤러리 컴포넌트
7. 반응형 디자인 적용

**의존성**: Phase 1 완료

**예상 기간**: 2-3주

---

### Phase 3: 스토어 등록 및 관리 [Priority: High]
**목표**: 판매자가 스토어를 등록하고 관리할 수 있는 기능 구현

**작업 항목**:
1. 스토어 등록 폼 구현
2. 이미지 업로드 기능 구현
3. 이미지 미리보기 기능
4. 스토어 정보 수정 기능
5. 폼 유효성 검사
6. 판매자 대시보드 (추후 추가)

**의존성**: Phase 1, Phase 2 완료

**예상 기간**: 2주

---

### Phase 4: 추가 기능 [Priority: Medium]
**목표**: 사용자 경험 향상을 위한 추가 기능 구현

**작업 항목**:
1. 즐겨찾기 기능 구현
2. 리뷰 및 평점 시스템 구현
3. 지도 통합 (Google Maps 또는 Kakao Map)
4. 알림 기능 (선택사항)
5. 검색 결과 개선

**의존성**: Phase 1, Phase 2, Phase 3 완료

**예상 기간**: 2-3주

---

## 6. 논리적 의존성 체인

```
Foundation Layer:
  Supabase 설정 → 데이터베이스 스키마 → 인증 시스템

Core Features Layer:
  프로필 관리 → 스토어 목록 → 스토어 상세

User Features Layer:
  검색/필터링 → 즐겨찾기 → 리뷰 시스템

Seller Features Layer:
  스토어 등록 → 이미지 업로드 → 스토어 관리

Enhancement Layer:
  지도 통합 → 실시간 업데이트 → 알림
```

각 단계는 이전 단계의 기능을 기반으로 구축되며, 각 기능은 독립적으로 테스트 가능하도록 설계됩니다.

---

## 7. 기술적 고려사항

### 7.1 기술적 도전 과제
- **Supabase RLS 정책 복잡성**: 
  - 해결책: 단계별로 정책을 테스트하고 문서화
- **이미지 최적화**: 
  - 해결책: Supabase Storage의 이미지 변환 기능 활용
- **지도 API 통합**: 
  - 해결책: API 키 관리 및 비용 고려, 환경 변수로 관리

### 7.2 MVP 정의
- **최소 기능**: 인증 + 스토어 목록/상세 + 스토어 등록
- **핵심 가치**: 사용자가 팝업 스토어를 쉽게 찾고 등록할 수 있는 것

### 7.3 리소스 제약사항
- Supabase 무료 플랜 제한사항 고려
- 이미지 저장 용량 관리 (Storage 용량 제한)
- API 호출 제한 관리 (월 API 호출 제한)

---

## 8. 사용자 플로우

### 8.1 스토어 탐색 플로우
```
메인 페이지 
  → 카테고리/지역 선택 
  → 스토어 목록 (필터링/검색) 
  → 스토어 상세 정보 확인
```

### 8.2 스토어 등록 플로우
```
로그인 
  → 스토어 등록 버튼 클릭 
  → 정보 입력 폼 작성 
  → 이미지 업로드 
  → 등록 완료
```

### 8.3 즐겨찾기 플로우
```
스토어 상세 페이지 
  → 즐겨찾기 버튼 클릭 
  → 마이페이지에서 즐겨찾기 목록 확인
```

### 8.4 리뷰 작성 플로우
```
스토어 상세 페이지 
  → 리뷰 작성 버튼 클릭 
  → 평점 선택 및 리뷰 작성 
  → 이미지 첨부 (선택) 
  → 제출
```

---

## 9. UI/UX 고려사항

- **모바일 우선 반응형 디자인**: 모바일 환경을 우선 고려
- **직관적인 네비게이션**: 사용자가 쉽게 원하는 기능을 찾을 수 있도록
- **빠른 로딩 속도**: 이미지 지연 로딩, 코드 스플리팅 활용
- **이미지 최적화**: 적절한 크기와 포맷 사용
- **접근성**: WCAG 가이드라인 준수

---

## 10. 테스트 전략

### 10.1 단위 테스트
- 컴포넌트 렌더링 테스트
- 유틸리티 함수 테스트
- 폼 유효성 검사 테스트

### 10.2 통합 테스트
- API 호출 테스트
- 인증 플로우 테스트
- 데이터베이스 쿼리 테스트

### 10.3 E2E 테스트
- 주요 사용자 플로우 테스트
- 크로스 브라우저 테스트

---

## 11. 배포 및 인프라

### 11.1 환경 변수
```
VITE_SUPABASE_URL=
VITE_SUPABASE_ANON_KEY=
```

### 11.2 배포 플랫폼
- Vercel 또는 Netlify (정적 호스팅)
- Supabase (백엔드)

---

## 12. 부록

### 12.1 기술 스펙 상세
- React: 19.2.0
- TypeScript: 5.9.3
- Vite: 7.2.4
- Tailwind CSS: 4.1.17
- Supabase JS Client: 2.86.0

### 12.2 연구 결과
- Supabase는 PostgreSQL 기반의 BaaS로 실시간 기능과 인증을 제공
- Row Level Security를 통해 데이터 보안 구현 가능
- Storage를 통한 이미지 관리 가능
